/**!
 * FlexSearch.js v0.7.0-pre-alpha
 * Copyright 2019 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/flexsearch
 */
(function(){var q;function u(a){for(var b=Array(a),c=0;c<a;c++)b[c]=B();return b}function B(){return Object.create(null)}function aa(a,b){return b.length-a.length};var C=/[\W_]+/;function ba(a){if(a=a.toLowerCase())if(a&&this.B&&(a=D(a,this.B)),this.D&&1<a.length&&(a=D(a,this.D)),a&&(C||""===C)&&(a=a.split(C),this.filter)){for(var b=this.filter,c=a.length,d=[],f=0,h=0;f<c;f++){var e=a[f];e&&!b[e]&&(d[h++]=e)}a=d}return a};function ca(a){for(var b=B(),c=0,d=a.length;c<d;c++)b[a[c]]=1;return b}function E(a,b){for(var c=Object.keys(a),d=c.length,f=[],h="",e=0,g=0,k,l;g<d;g++)k=c[g],(l=a[k])?(f[e++]=new RegExp(b?"(?!\\b)"+k+"(\\b|_)":k,"g"),f[e++]=l):h+=(h?"|":"")+k;h&&(f[e++]=new RegExp(b?"(?!\\b)("+h+")(\\b|_)":"("+h+")","g"),f[e]="");return f}function D(a,b){for(var c=0,d=b.length;c<d&&(a=a.replace(b[c],b[c+1]),a);c+=2);return a};var F={},G={};var H=Promise;Object.assign||(Object.assign=function(){for(var a=arguments,b=a.length,c=a[0],d=1,f,h,e;d<b;d++){f=a[d];h=Object.keys(f);e=h.length;for(var g=0,k;g<e;g++)k=h[g],c[k]=f[k]}return c});if(!H){var I=function(a){this.g=null;var b=this;a(function(c){b.g&&(b.g(c),b=b.g=null)})};I.prototype.then=function(a){this.g=a};H=I};function J(a,b,c){return K.call(this,this.add,arguments)}function L(a,b,c){return K.call(this,this.append,arguments)}function M(a,b,c){return K.call(this,this.search,arguments)}function N(a,b,c){return K.call(this,this.update,arguments)}function O(a,b){return K.call(this,this.remove,arguments)}function K(a,b){for(var c,d=0;d<b.length;d++)if("function"===typeof b[d]){c=b[d];delete b[d];break}var f=this;d=new H(function(h){setTimeout(function(){h(a.apply(f,b))})});return c?(d.then(c),this):d};function P(a,b,c){var d=a.length,f=[],h=B(),e=0;c&&(c=[]);for(var g=0;g<d;g++){for(var k=a[g],l=k.length,r=B(),p=!g,n=0;n<l;n++){var m=k[n],t=m.length;if(t){c&&(c[n]=[]);for(var v=0,x=0,w;v<t;v++)if(w=m[v],!g)r[w]=1;else if(h[w]){if(g===d-1){if(f[e++]=w,e===b)return f}else c&&x<b&&(c[n][x++]=w),r[w]=1;p=!0}}}if(!p&&!c)return[];h=r}if(c)for(a=c.length-1;0<=a;a--)if(h=(d=c[a])&&d.length){if(e+h>=b)return f.concat(d.slice(0,b-e));f=f.concat(d);e+=h}return f};function Q(a){this.h=!0!==a&&a;this.cache=B();this.g=[]}function R(a,b,c){"object"===typeof a&&(a=a.query);var d=this.cache.get(a);d||(d=this.search(a,b,c),this.cache.set(a,d));return d}Q.prototype.set=function(a,b){if(!this.cache[a]){var c=this.g.length;c===this.h?delete this.cache[this.g[c-1]]:c++;for(--c;0<c;c--)this.g[c]=this.g[c-1];this.g[0]=a}this.cache[a]=b};
Q.prototype.get=function(a){var b=this.cache[a];if(this.h&&b&&(a=this.g.indexOf(a))){var c=this.g[a-1];this.g[a-1]=this.g[a];this.g[a]=c}return b};var da={memory:{charset:"latin:extra",o:3,l:3,s:!1,m:"memory"},performance:{threshold:8,l:3,context:{depth:1,v:!0}},match:{charset:"latin:extra",G:"full",o:3},score:{charset:"latin:advanced",threshold:1,context:{depth:3,v:!0}},"default":{o:3,threshold:0,depth:3}};function ea(a){if("string"===typeof a)a=da[a];else{var b=a.preset;b&&(a=Object.assign({},da[b],a))}return a};function S(a,b){if(!(this instanceof S))return new S(a);if(a){a=ea(a);var c=a.charset;var d=a.lang;"string"===typeof c&&(-1===c.indexOf(":")&&(c+=":default"),c=G[c]);"string"===typeof d&&(d=F[d])}else a={};var f,h=a.context||{};this.encode=a.encode||c&&c.encode||ba;this.register=b||B();var e=a.resolution||9;var g=a.threshold||0;g>=e&&(g=e-1);this.o=e;this.threshold=g;this.A=b=c&&c.G||a.tokenize||"strict";this.depth="strict"===b&&h.depth;this.v=T(h.bidirectional,!0);this.m=f="memory"===a.optimize;
this.s=T(a.fastupdate,!0);this.l=a.minlength||1;this.g=f?u(e-g):B();e=h.resolution||e;g=h.threshold||g;g>=e&&(g=e-1);this.h=e;this.j=g;this.i=f?u(e-g):B();this.C=c&&c.C||a.rtl;this.B=(b=a.matcher||d&&d.B)&&E(b,!1);this.D=(b=a.stemmer||d&&d.D)&&E(b,!0);this.filter=(b=a.filter||d&&d.filter)&&ca(b);this.cache=(b=a.cache)&&new Q(b);this.u=(b=a.worker)&&new Worker("worker.js",{type:"module"});b&&(this.u.onmessage=function(k){console.log(k.data)},this.u.postMessage({H:"register",options:a}))}
function T(a,b){return"undefined"!==typeof a?a:b}q=S.prototype;q.append=function(a,b){return this.add(a,b,!0)};
q.add=function(a,b,c){if(this.register[a]&&!c)return this.update(a,b);if(b&&(a||0===a)){b=this.encode(b);var d=b.length;if(d){for(var f=this.depth,h=this.o-this.threshold,e=B(),g=B(),k=0;k<d;k++){var l=b[this.C?d-1-k:k],r=l.length;if(l&&r>=this.l&&(f||!e[l])){var p=Math.min(this.o/d*k|0,k);if(p<h){var n="";switch(this.A){case "full":if(3<r){for(var m=0;m<r;m++){var t=m?Math.min(p/2+this.o/r*m/2|0,p+m):p;if(t<h)for(var v=r;v>m;v--)n=l.substring(m,v),n.length>=this.l&&U(this,e,n,t,a,c)}break}case "reverse":if(2<
r){for(m=r-1;0<m;m--)n=l[m]+n,n.length>=this.l&&U(this,e,n,p,a,c);n=""}case "forward":if(1<r)for(m=0;m<r;m++)n+=l[m],n.length>=this.l&&U(this,e,n,p,a,c);break;default:if(U(this,e,l,p,a,c),f&&1<d&&k<d-1)for(r=this.h-this.j,p=B(),n=l,m=Math.min(f+1,d-k),t=p[n]=1;t<m;t++)if((l=b[this.C?d-1-k-t:k+t])&&l.length>=this.l&&!p[l]){if(p[l]=1,v=Math.min((this.h-m)/d*k+t|0,k+(t-1)),v<r){var x=this.v&&l>n;U(this,g,x?n:l,v,a,c,x?l:n)}}else m=Math.min(m+1,d-k)}}}}this.s||(this.register[a]=1)}}return this};
function U(a,b,c,d,f,h,e){var g=e?a.i:a.g;if(!b[c]||e&&!b[c][e])a.m&&(g=g[d]),e?(b[c]||(b[c]=B()),b[c][e]=1,g=g[e]||(g[e]=B())):b[c]=1,g=g[c]||(g[c]=[]),a.m||(g=g[d]||(g[d]=[])),h&&-1!==g.indexOf(f)||(g[g.length]=f,a.s&&(a=a.register[f]||(a.register[f]=[]),a[a.length]=g))}
q.search=function(a,b,c){"object"===typeof a?(c=a,a=c.query):"object"===typeof b&&(c=b);var d=[],f=this.threshold;if(c){b=c.limit;f=T(c.threshold,f);var h=c.context;var e=c.suggest}if(a){a=this.encode(a);var g=a.length;if(1<g){c=B();for(var k=[],l=0,r=0,p;l<g;l++)if((p=a[l])&&p.length>=this.l&&!c[p])if(this.m||e||this.g[p])k[r++]=p,c[p]=1;else return d;a=k;g=a.length}}if(!g)return d;b||(b=100);c=this.o-f;f=this.h-f;h=this.depth&&1<g&&!1!==h;k=0;if(h){var n=a[0];k=1}else 1<g&&a.sort(aa);for(;k<g;k++){r=
a[k];h?(l=fa(this,d,e,f,b,2===g,r,n),e&&!1===l&&d.length||(n=r)):l=fa(this,d,e,c,b,1===g,r);if(l)return l;if(e&&k===g-1){l=d.length;if(!l){if(h){h=0;k=-1;continue}return d}if(1===l)return d=d[0],d=1===d.length?d[0]:[].concat.apply([],d),d.length>b?d.slice(0,b):d}}return P(d,b,e)};function ha(a,b,c,d){c?(d=d&&b>c,a=(a=a[d?b:c])&&a[d?c:b]):a=a[b];return a}
function fa(a,b,c,d,f,h,e,g){var k=[],l=g?a.i:a.g;a.m||(l=ha(l,e,g,a.v));if(l){var r=0;d=Math.min(l.length,d);for(var p=0,n=0,m;p<d&&!(m=l[p],a.m&&(m=ha(m,e,g,a.v)),m&&(k[r++]=m,h&&(n+=m.length,n>=f)));p++);if(r){if(h)return k=1===r?k[0]:[].concat.apply([],k),k.length>f?k.slice(0,f):k;b[b.length]=k;return}}return!c&&k}q.contain=function(a){return!!this.register[a]};q.update=function(a,b){return this.remove(a).add(a,b)};
q.remove=function(a,b){var c=this.register[a];if(c){if(this.s)for(var d=0,f;d<c.length;d++)f=c[d],f.splice(f.indexOf(a),1);else V(this.g,a,this.o-this.threshold,this.m),this.depth&&V(this.i,a,this.h-this.j,this.m);b||delete this.register[a];if(this.cache)for(b=this.cache,c=0;c<b.g.length;c++)f=b.g[c],d=b.cache[f],-1!==d.indexOf(a)&&(b.g.splice(c--,1),delete b.cache[f])}return this};
function V(a,b,c,d,f){var h=0;if(a.constructor===Array)if(f)b=a.indexOf(b),-1!==b?1<a.length&&(a.splice(b,1),h++):h++;else{f=Math.min(a.length,c);for(var e=0,g;e<f;e++)if(g=a[e])h=V(g,b,c,d,f),d||h||delete a[e]}else for(e in a)(h=V(a[e],b,c,d,f))||delete a[e];return h}q.searchCache=R;q.addAsync=J;q.appendAsync=L;q.searchAsync=M;q.updateAsync=N;q.removeAsync=O;function W(a){if(!(this instanceof W))return new W(a);var b;a||(a={});this.F=[];this.h=[];this.i=[];this.register=B();this.key=(b=a.key)&&X(b,this.i)||"id";b=a.fastupdate;this.s="undefined"!==typeof b?b:!0;this.store=(b=a.store)&&B();this.j=b&&!0!==b&&[];this.u=(b=a.tag)&&X(b,this.i);this.g=b&&B();this.cache=(b=a.cache)&&new Q(b);a.cache=!1;b=a;a=B();var c=b.doc;if("string"===typeof c)c=[c];else if(c.constructor!==Array){var d=c;c=Object.keys(c)}for(var f=0,h,e;f<c.length;f++)h=c[f],d?(e=d[h],e="object"===
typeof e?Object.assign({},b,e):b):e=b,a[h]=new S(e,this.register),this.F[f]=X(h,this.i),this.h[f]=h;if(this.j)for(d=b.store,"string"===typeof d&&(d=[d]),b=0;b<d.length;b++)this.j[b]=X(d[b],this.i);this.A=a}function X(a,b){for(var c=a.split(":"),d=0,f=0;f<c.length;f++)a=c[f],0<=a.indexOf("[]")&&(a=a.substring(0,a.length-2))&&(b[d]=!0),a&&(c[d++]=a);d<c.length&&(c.length=d);return 1<d?c:c[0]}function ia(a,b){if("string"===typeof b)a=a[b];else for(var c=0;a&&c<b.length;c++)a=a[b[c]];return a}
function Y(a,b,c,d,f){a=a[f];if(d===c.length-1)b[f]=a;else if(a)if(a.constructor===Array)for(b=b[f]=Array(a.length),f=0;f<a.length;f++)Y(a,b,c,d,f);else b=b[f]||(b[f]=B()),f=c[++d],Y(a,b,c,d,f)}function Z(a,b,c,d,f,h,e,g){a=a[e];if(d===b.length-1){if(a.constructor===Array){if(c[d]){for(b=0;b<a.length;b++)f.add(h,a[b],!0);return}a=a.join(" ")}f.add(h,a,g)}else if(a)if(a.constructor===Array)for(e=0;e<a.length;e++)Z(a,b,c,d,f,h,e,g);else e=b[++d],Z(a,b,c,d,f,h,e,g)}q=W.prototype;
q.add=function(a,b,c){"object"===typeof a&&(b=a,a=ia(b,this.key));if(b&&(a||0===a)){if(this.register[a])return this.update(a,b);for(var d=0,f,h;d<this.h.length;d++)h=this.h[d],f=this.F[d],"string"===typeof f&&(f=[f]),Z(b,f,this.i,0,this.A[h],a,f[0],c);if(this.u){d=ia(b,this.u);f=B();"string"===typeof d&&(d=[d]);h=0;for(var e;h<d.length;h++)if(e=d[h],!f[e]&&(f[e]=1,e=this.g[e]||(this.g[e]=[]),!c||-1===e.indexOf(a)))if(e[e.length]=a,this.s){var g=this.register[a]||(this.register[a]=[]);g[g.length]=
e}}if(this.store){if(this.j){var k=B();for(c=0;c<this.j.length;c++)d=this.j[c],"string"===typeof d?k[d]=b[d]:Y(b,k,d,0,d[0])}this.store[a]=k||b}}return this};q.append=function(a,b){return this.add(a,b,!0)};q.update=function(a,b){return this.remove(a).add(a,b)};
q.remove=function(a){"object"===typeof a&&(a=a[this.key]);if(this.register[a]){for(var b=0;b<this.h.length;b++)this.A[this.h[b]].remove(a,!0);if(this.u&&!this.s)for(var c in this.g){b=this.g[c];var d=b.indexOf(a);-1!==d&&(1<b.length?b.splice(d,1):delete this.g[c])}this.store&&delete this.store[a];delete this.register[a]}return this};
q.search=function(a,b,c){"object"===typeof a?(c=a,a=c.query):"object"===typeof b&&(c=b);var d=[],f,h=0;if(c){var e=(f=c.pluck)||c.field;var g=c.tag;var k=c.enrich;var l="and"===c.bool;b=c.limit;if(e)if("string"===typeof e)e=[e];else if(e.constructor!==Array){var r=e;e=Object.keys(e)}if(g&&("string"===typeof g&&(g=[g]),!a)){for(f=0;f<g.length;f++){e=g[f];var p=b||100;(c=(a=this.g[e])&&a.length)?(c>p&&(a=a.slice(0,p)),k&&this.store&&(a=ja.call(this,a)),e={tag:e,result:a}):e=void 0;e&&(d[d.length]=e,
h++)}return h?d:[]}}e||(e=this.h);l=l&&(1<e.length||g&&1<g.length);p=[];for(var n=0,m,t,v;n<e.length;n++){t=e[n];m=this.A[t].search(a,b,r?r[t]:c);v=m.length;if(g&&v){var x=p[n]=[];t=[];var w=0;l&&(t[0]=[m]);for(var y=0,A,z;y<g.length;y++)if(A=g[y],v=(z=this.g[A])&&z.length)t[t.length]=l?[z]:z,x[w++]=A;if(w){if(l)t=P(t,b||100);else{w=m;m=B();v=B();x=[];for(y=0;y<w.length;y++)m[w[y]]=1;for(w=0;w<t.length;w++)for(y=t[w],A=0;A<y.length;A++)z=y[A],m[z]&&!v[z]&&(v[z]=1,x[x.length]=z);t=x}m=t;v=m.length}}if(v)d[h++]=
m;else if(l)return[]}if(!h)return[];if(f&&(!k||!this.store))return d[0];for(b=0;b<e.length;b++){h=e[b];g=d[b];g.length&&k&&this.store&&(g=ja.call(this,g));if(f)return g;d[b]=g={field:h,result:g};this.u&&(g.tag=p[b])}return d};function ja(a){for(var b=Array(a.length),c=0,d;c<a.length;c++)d=a[c],b[c]={key:d,doc:this.store[d]};return b}q.contain=function(a){return!!this.register[a]};q.get=function(a){return this.store[a]};q.set=function(a,b){this.store[a]=b;return this};q.searchCache=R;q.addAsync=J;
q.appendAsync=L;q.searchAsync=M;q.updateAsync=N;q.removeAsync=O;window.FlexSearch={Index:S,Document:W,registerCharset:function(a,b){G[a]=b},registerLanguage:function(a,b){F[a]=b}};}).call(this);
